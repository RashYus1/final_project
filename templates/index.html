<!DOCTYPE html>
<html lang="en">

<head>
    <meta name="viewport" content="initial-scale=1, width=device-width">
    <title>Shows</title>
</head>

<body>

    <input id="search" autocomplete="off" autofocus placeholder="Search shows" type="text">

    <ul id="results"></ul>

    <script>
        const input = document.getElementById('search');
        const resultsList = document.getElementById('results');

        input.addEventListener('input', async function () {
            const query = input.value.trim();

            if (query.length === 0) {
                resultsList.innerHTML = '';
                return;
            }

            try {
                const response = await fetch('/search?q=' + encodeURIComponent(query));
                const shows = await response.json();
                let html = '';
                for (let show of shows) {
                    // Escape HTML special characters to prevent XSS
                    let title = show.title
                        .replace(/&/g, '&amp;')
                        .replace(/</g, '&lt;')
                        .replace(/>/g, '&gt;');
                    html += `<li>${title}</li>`;
                }
                resultsList.innerHTML = html;
            } catch (error) {
                console.error('Error fetching search results:', error);
                resultsList.innerHTML = '<li>Error loading results</li>';
            }
        });
    </script>

</body>

</html>
